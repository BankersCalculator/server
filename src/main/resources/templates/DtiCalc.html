<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>DTI Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            width: 80%;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        h1 {
            text-align: center;
        }
        .description {
            margin-bottom: 20px;
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
        }
        .description p {
            margin: 0;
        }
        .formula {
            text-align: center;
            font-weight: bold;
            margin: 20px 0;
        }
        .form-group {
            margin-bottom: 15px;
            position: relative;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center; /* Center align all form groups */
        }
        label {
            display: block;
            width: 50%; /* Match width of input-container and buttons */
            margin-bottom: 5px;
            text-align: left; /* Left align labels */
        }
        .input-container {
            display: inline-flex;
            align-items: center;
            width: 50%; /* Adjusted to 50% width to accommodate unit */
            margin-bottom: 5px;
        }
        input[type="number"], input[type="text"], input[type="date"], select {
            width: 100%; /* Adjusted to 100% width of the container */
            padding: 8px;
            box-sizing: border-box;
            text-align: right; /* Right align text */
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0; /* Remove up/down arrows for Webkit browsers */
        }
        input::placeholder {
            color: #ccc;
        }
        .form-group .unit {
            margin-left: 5px;
            color: #888;
        }
        .form-group .buttons {
            display: flex;
            justify-content: flex-start; /* Align buttons to the start */
            width: 50%; /* Match the width of the input */
            gap: 2%; /* Add gap between buttons */
        }
        .buttons button {
            flex: 1; /* Allow buttons to take up equal space */
            padding: 8px;
            cursor: pointer;
        }
        button.calculate, button.reset {
            display: block;
            width: 50%;
            padding: 10px;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin: 20px auto; /* Center align the buttons */
        }
        button.calculate {
            background-color: #007bff;
        }
        button.calculate:hover {
            background-color: #0056b3;
        }
        button.reset {
            background-color: #6c757d;
        }
        button.reset:hover {
            background-color: #5a6268;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            text-align: center; /* Center align the result */
        }
        .section-title {
            font-size: 1.5em;
            margin-top: 20px;
            border-bottom: 2px solid #000;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        .formatted-value {
            font-size: 0.9em;
            color: #888;
            text-align: right; /* Left align formatted values */
            width: 50%; /* Match width of input-container */
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’°DTI ê³„ì‚°ê¸°ğŸ </h1>
        <div class="description">
            <p> ğŸ‘‰ DTI (Debt to Income ratio, ì´ë¶€ì±„ìƒí™˜ë¹„ìœ¨)ëŠ” ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì°¨ì£¼ì˜ ì›ë¦¬ê¸ˆìƒí™˜ëŠ¥ë ¥ì„ ê°ì•ˆí•˜ì—¬ ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ ë„ì…ëœ ê·œì œ ë¹„ìœ¨ì…ë‹ˆë‹¤.
                ì´ëŠ” LTV ê·œì œ ê°•í™”ì˜ í›„ì†ì¡°ì¹˜ë¡œ 2005ë…„ 8ì›” ë„ì…ë˜ì—ˆìœ¼ë©°, ì´ëŠ” ì°¨ì£¼ì˜ ì†Œë“ìˆ˜ì¤€ê³¼ ê´€ê³„ì—†ì´ ì£¼íƒê°€ê²©ì— ë¹„ë¡€í•˜ì—¬ ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ê°€ ê²°ì •ë˜ëŠ” LTV ê·œì œì˜ ë¬¸ì œì ì„ ë³´ì™„í•˜ê³ ì ë„ì…ëœ ê²ƒì…ë‹ˆë‹¤. 
                ì˜ˆë¥¼ ë“¤ì–´ ì €ê¸ˆë¦¬ í•˜ì—ì„œ ì£¼íƒê°€ê²© ìƒìŠ¹ì„¸ê°€ í™•ëŒ€ë  ê²½ìš° DTI ë° LTV ê·œì œë¥¼ ê°•í™”í•˜ë©´ ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ê°€ ì¶•ì†Œë˜ì–´ ì£¼íƒì‹œì¥ ê³¼ì—´ì„ ì–µì œí•˜ëŠ” íš¨ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br>
                [í•œêµ­ì€í–‰, ê²½ì œìš©ì–´ì‚¬ì „ ë°œì·Œ]<br>
            </p>
        </div>
        <div class="formula">
            ğŸ¦ DTI = (í•´ë‹¹ ì£¼íƒë‹´ë³´ëŒ€ì¶œì˜ ì—°ê°„ ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡ + ê¸°íƒ€ë¶€ì±„ì˜ ì—°ê°„ ì´ììƒí™˜ì•¡) / ì—°ì†Œë“ Ã— 100 <br>[ì€í–‰ì—… ê°ë…ê·œì •]
        </div>
        <form th:action="@{/dti/result}" th:object="${dtiCalcRequest}" method="post">
            <div class="form-group">
                <label>ì—°ì†Œë“ (ì„¸ì „, ì¦ë¹™ê°€ëŠ¥í•œ ì†Œë“ê¸°ì¤€)</label>
                <div class="input-container">
                    <input type="number" th:field="*{annualIncome}" id="annualIncome" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-annualIncome')" />
                    <span class="unit">ì›</span>
                </div>
                <div class="buttons">
                    <button type="button" onclick="adjustValue('annualIncome', 1000000)">+100ë§Œ</button>
                    <button type="button" onclick="adjustValue('annualIncome', 10000000)">+1000ë§Œ</button>
                    <button type="button" onclick="adjustValue('annualIncome', 100000000)">+1ì–µ</button>
                </div>
                <div class="formatted-value" id="formatted-annualIncome">0ì›</div>
            </div>
            <div class="form-group">
                <label>ì£¼íƒ êµ¬ë§¤ì— í•„ìš”í•˜ì‹  ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”(ëŒ€ì¶œê¸ˆì•¡)</label>
                <div class="input-container">
                    <input type="number" th:field="*{applicationAmount}" id="applicationAmount" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-applicationAmount')" />
                    <span class="unit">ì›</span>
                </div>
                <div class="buttons">
                    <button type="button" onclick="adjustValue('applicationAmount', 1000000)">+100ë§Œ</button>
                    <button type="button" onclick="adjustValue('applicationAmount', 10000000)">+1000ë§Œ</button>
                    <button type="button" onclick="adjustValue('applicationAmount', 100000000)">+1ì–µ</button>
                </div>
                <div class="formatted-value" id="formatted-applicationAmount">0ì›</div>
            </div>
            <div class="form-group">
                <label>ëŒ€ì¶œ ë§Œê¸° ë•Œ, ì¼ì •ê¸ˆì•¡ì„ ë‚¨ê¸°ì‹¤ê±´ê°€ìš”?(ë§Œê¸°ìƒí™˜ê¸ˆì•¡)</label>
                <div class="input-container">
                    <input type="number" th:field="*{maturityRepaymentAmount}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-maturityRepaymentAmount')" />
                    <span class="unit">ì›</span>
                </div>
				<div class="buttons">
				     <button type="button" onclick="adjustValue('maturityRepaymentAmount', 1000000)">+100ë§Œ</button>
				     <button type="button" onclick="adjustValue('maturityRepaymentAmount', 10000000)">+1000ë§Œ</button>
				     <button type="button" onclick="adjustValue('maturityRepaymentAmount', 100000000)">+1ì–µ</button>
			    </div>
                <div class="formatted-value" id="formatted-maturityRepaymentAmount">0ì›</div>
            </div>
            <div class="form-group">
                <label>ë§¤ë‹¬ ë‚©ë¶€í•˜ì‹¤ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”(ìƒí™˜ë°©ì‹)</label>
                <select th:field="*{repaymentMethod}" style="width: 50%;">
                    <option value="equalPayment">ì›ë¦¬ê¸ˆê· ë“±ë¶„í• ìƒí™˜ë°©ì‹</option>
                    <option value="equalPrincipal">ì›ê¸ˆê· ë“±ë¶„í• ìƒí™˜ë°©ì‹</option>
                </select>
            </div>
            <div class="form-group">
                <label>ëŒ€ì¶œ ê¸°ê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                <div class="input-container">
                    <input type="number" th:field="*{loanPeriod}" id="loanPeriod" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-loanPeriod')" />
                    <span class="unit">ë…„</span>
                </div>
                <div class="buttons">
                    <button type="button" onclick="adjustValue('loanPeriod', 1)">+1ë…„</button>
                    <button type="button" onclick="adjustValue('loanPeriod', 5)">+5ë…„</button>
                    <button type="button" onclick="adjustValue('loanPeriod', 10)">+10ë…„</button>
                </div>
            </div>
            <div class="form-group">
                <label>ì¼ì • ê¸°ê°„ ì´ìë§Œ ë‚©ë¶€í•˜ì‹¤ê±´ê°€ìš”?(ê±°ì¹˜ê¸°ê°„)</label>
                <div class="input-container">
                    <input type="number" th:field="*{gracePeriod}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-gracePeriod')" />
                    <span class="unit">ë…„</span>
                </div>
            </div>
            <div class="form-group">
                <label>ì´ììœ¨</label>
                <div class="input-container">
                    <input type="number" step="0.01" th:field="*{interestRate}" id="interestRate" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="formatPercentage(this)" />
                    <span class="unit">%</span>
                </div>
                <div class="formatted-value" id="formatted-interestRate">0%</div>
            </div>
            <div class="form-group">
                <label>ëŒ€ì¶œ ë‹¹ì¼, ìƒí™˜í•˜ì‹¤ ì£¼íƒë‹´ë³´ëŒ€ì¶œê¸ˆì•¡ì´ ìˆìœ¼ì‹ ê°€ìš”? (ëŒ€í™˜ì—¬ë¶€)</label>
                <div class="input-container">
                    <input type="number" th:field="*{repaymentAmount}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-repaymentAmount')" />
                    <span class="unit">ì›</span>
                </div>
				<div class="buttons">
				     <button type="button" onclick="adjustValue('repaymentAmount', 1000000)">+100ë§Œ</button>
				     <button type="button" onclick="adjustValue('repaymentAmount', 10000000)">+1000ë§Œ</button>
				     <button type="button" onclick="adjustValue('repaymentAmount', 100000000)">+1ì–µ</button>
				</div>
                <div class="formatted-value" id="formatted-repaymentAmount">0ì›</div>
            </div>
            <div class="form-group">
                <label>ì˜ˆê¸ˆì´ë‚˜ ì ê¸ˆìœ¼ë¡œ ë°›ìœ¼ì‹  ëŒ€ì¶œì´ ìˆìœ¼ì‹ ê°€ìš”?(ì˜ˆì ê¸ˆëŒ€ì¶œ)</label>
                <div class="input-container">
                    <input type="number" th:field="*{savingsLoanAmount}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-savingsLoanAmount')" />
                    <span class="unit">ì›</span>
                </div>
				<div class="buttons">
				     <button type="button" onclick="adjustValue('savingsLoanAmount', 1000000)">+100ë§Œ</button>
				     <button type="button" onclick="adjustValue('savingsLoanAmount', 10000000)">+1000ë§Œ</button>
				     <button type="button" onclick="adjustValue('savingsLoanAmount', 100000000)">+1ì–µ</button>
				</div>
                <div class="formatted-value" id="formatted-savingsLoanAmount">0ì›</div>
            </div>
            <div class="form-group">
                <label>ì´ë¯¸ ë°›ìœ¼ì‹  ì£¼íƒë‹´ë³´ëŒ€ì¶œì´ ìˆìœ¼ì‹ ê°€ìš”?</label>
                <div class="input-container">
                    <input type="number" th:field="*{mortgageLoanAmount}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-mortgageLoanAmount')" />
                    <span class="unit">ì›</span>
                </div>
				<div class="buttons">
				     <button type="button" onclick="adjustValue('mortgageLoanAmount', 1000000)">+100ë§Œ</button>
				     <button type="button" onclick="adjustValue('mortgageLoanAmount', 10000000)">+1000ë§Œ</button>
				     <button type="button" onclick="adjustValue('mortgageLoanAmount', 100000000)">+1ì–µ</button>
				</div>
                <div class="formatted-value" id="formatted-mortgageLoanAmount">0ì›</div>
            </div>
            <div class="form-group">
                <label>ê¸°íƒ€, ë°›ê³ ê³„ì‹  ëŒ€ì¶œê¸ˆì•¡ì´ ì–¼ë§ˆì‹ ê°€ìš”? (ìœ„ì˜ ì˜ˆì ê¸ˆë‹´ë³´ëŒ€ì¶œ, ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì œì™¸)</label>
                <div class="input-container">
                    <input type="number" th:field="*{otherDebtAmount}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-otherDebtAmount')" />
                    <span class="unit">ì›</span>
                </div>
				<div class="buttons">
				     <button type="button" onclick="adjustValue('otherDebtAmount', 1000000)">+100ë§Œ</button>
				     <button type="button" onclick="adjustValue('otherDebtAmount', 10000000)">+1000ë§Œ</button>
				     <button type="button" onclick="adjustValue('otherDebtAmount', 100000000)">+1ì–µ</button>
				</div>
                <div class="formatted-value" id="formatted-otherDebtAmount">0ì›</div>
            </div>
            <div class="form-group">
                <label>í˜„ì¬ ë‚©ë¶€ì¤‘ì¸ ì—° ì›ë¦¬ê¸ˆ /ì—°ì´ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                <div class="input-container">
                    <input type="number" th:field="*{currentAnnualRepaymentOrInterest}" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-currentAnnualRepaymentOrInterest')" />
                    <span class="unit">ì›</span>
                </div>
                <div class="formatted-value" id="formatted-currentAnnualRepaymentOrInterest">0ì›</div>
            </div>
            <button type="submit" class="calculate">Calculate</button>
            <button type="button" class="reset" onclick="resetForm()">ì´ˆê¸°í™”</button>
        </form>

        <div class="result" th:if="${dtiCalcResponse != null}">
            <h2>ê²°ê³¼</h2>
            <p th:utext="${dtiCalcResponse.getCtt}"></p>			
        </div>
    </div>
    <script>
        function adjustValue(id, amount) {
            var input = document.getElementById(id);
            input.value = parseInt(input.value || 0) + amount;
            updateFormattedValue(input, 'formatted-' + id);
        }

        function resetForm() {
            document.querySelectorAll('input[type="number"], input[type="text"], input[type="date"], select').forEach(input => {
                input.value = '';
                input.placeholder = '0';
            });
            document.querySelectorAll('.formatted-value').forEach(el => el.textContent = '0ì›');
        }

        function formatCurrency(value) {
            var formattedValue = '';
            if (value >= 100000000) {
                var eok = Math.floor(value / 100000000);
                var remainder = value % 100000000;
                var man = Math.floor(remainder / 10000);
                if (man > 0) {
                    formattedValue = eok + 'ì–µ ' + man + 'ë§Œì›';
                } else {
                    formattedValue = eok + 'ì–µì›';
                }
            } else if (value >= 10000) {
                var man = Math.floor(value / 10000);
                var rest = value % 10000;
                formattedValue = man + 'ë§Œì›';
            } else {
                formattedValue = value.toLocaleString() + 'ì›';
            }
            return formattedValue;
        }

        function updateFormattedValue(input, formattedValueId) {
            var value = parseInt(input.value.replace(/,/g, '')) || 0;
            var formattedValue = formatCurrency(value);
            document.getElementById(formattedValueId).textContent = formattedValue;
        }

        function formatPercentage(input) {
            var value = parseFloat(input.value) || 0;
            document.getElementById('formatted-' + input.id).textContent = value.toFixed(2) + '%';
        }
    </script>
</body>
</html>