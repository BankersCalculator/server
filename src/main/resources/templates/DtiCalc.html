<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>DTI Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            width: 80%;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        h1 {
            text-align: center;
        }
        .description {
            margin-bottom: 20px;
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
        }
        .description p {
            margin: 0;
        }
        .formula {
            text-align: center;
            font-weight: bold;
            margin: 20px 0;
        }
        .form-group {
            margin-bottom: 15px;
            position: relative;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center; /* Center align all form groups */
        }
        label {
            display: block;
            width: 50%; /* Match width of input-container and buttons */
            margin-bottom: 5px;
            text-align: left; /* Left align labels */
        }
        .input-container {
            display: inline-flex;
            align-items: center;
            width: 50%; /* Adjusted to 50% width to accommodate unit */
            margin-bottom: 5px;
        }
        input[type="number"], input[type="text"], input[type="date"], select {
            width: 100%; /* Adjusted to 100% width of the container */
            padding: 8px;
            box-sizing: border-box;
            text-align: right; /* Right align text */
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0; /* Remove up/down arrows for Webkit browsers */
        }
        input::placeholder {
            color: #ccc;
        }
        .form-group .unit {
            margin-left: 5px;
            color: #888;
        }
        .form-group .buttons {
            display: flex;
            justify-content: flex-start; /* Align buttons to the start */
            width: 50%; /* Match the width of the input */
            gap: 2%; /* Add gap between buttons */
        }
        .buttons button {
            flex: 1; /* Allow buttons to take up equal space */
            padding: 8px;
            cursor: pointer;
        }
        button.calculate, button.reset {
            display: block;
            width: 50%;
            padding: 10px;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin: 20px auto; /* Center align the buttons */
        }
        button.calculate {
            background-color: #007bff;
        }
        button.calculate:hover {
            background-color: #0056b3;
        }
        button.reset {
            background-color: #6c757d;
        }
        button.reset:hover {
            background-color: #5a6268;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            text-align: center; /* Center align the result */
        }
        .section-title {
            font-size: 1.5em;
            margin-top: 20px;
            border-bottom: 2px solid #000;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        .formatted-value {
            font-size: 0.9em;
            color: #888;
            text-align: right; /* Left align formatted values */
            width: 50%; /* Match width of input-container */
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’°DTI ê³„ì‚°ê¸°ğŸ </h1>
        <div class="description">
            <p> ğŸ‘‰ DTI (Debt to Income ratio, ì´ë¶€ì±„ìƒí™˜ë¹„ìœ¨)ëŠ” ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì°¨ì£¼ì˜ ì›ë¦¬ê¸ˆìƒí™˜ëŠ¥ë ¥ì„ ê°ì•ˆí•˜ì—¬ ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ ë„ì…ëœ ê·œì œ ë¹„ìœ¨ì…ë‹ˆë‹¤.
                ì´ëŠ” LTV ê·œì œ ê°•í™”ì˜ í›„ì†ì¡°ì¹˜ë¡œ 2005ë…„ 8ì›” ë„ì…ë˜ì—ˆìœ¼ë©°, ì´ëŠ” ì°¨ì£¼ì˜ ì†Œë“ìˆ˜ì¤€ê³¼ ê´€ê³„ì—†ì´ ì£¼íƒê°€ê²©ì— ë¹„ë¡€í•˜ì—¬ ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ê°€ ê²°ì •ë˜ëŠ” LTV ê·œì œì˜ ë¬¸ì œì ì„ ë³´ì™„í•˜ê³ ì ë„ì…ëœ ê²ƒì…ë‹ˆë‹¤. 
                ì˜ˆë¥¼ ë“¤ì–´ ì €ê¸ˆë¦¬ í•˜ì—ì„œ ì£¼íƒê°€ê²© ìƒìŠ¹ì„¸ê°€ í™•ëŒ€ë  ê²½ìš° DTI ë° LTV ê·œì œë¥¼ ê°•í™”í•˜ë©´ ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ê°€ ì¶•ì†Œë˜ì–´ ì£¼íƒì‹œì¥ ê³¼ì—´ì„ ì–µì œí•˜ëŠ” íš¨ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br>
                [í•œêµ­ì€í–‰, ê²½ì œìš©ì–´ì‚¬ì „ ë°œì·Œ]<br>
            </p>
        </div>
        <div class="formula">
            ğŸ¦ DTI = (í•´ë‹¹ ì£¼íƒë‹´ë³´ëŒ€ì¶œì˜ ì—°ê°„ ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡ + ê¸°íƒ€ë¶€ì±„ì˜ ì—°ê°„ ì´ììƒí™˜ì•¡) / ì—°ì†Œë“ Ã— 100 <br>[ì€í–‰ì—… ê°ë…ê·œì •]
        </div>
        <form th:action="@{/dti/result}" th:object="${dtiCalcRequest}" method="post">
            <div class="form-group">
                <label>ì—°ì†Œë“ (ì„¸ì „, ì¦ë¹™ê°€ëŠ¥í•œ ì†Œë“ê¸°ì¤€)</label>
                <div class="input-container">
                    <input type="number" th:field="*{annualIncome}" id="annualIncome" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-annualIncome')" required />
                    <span class="unit">ì›</span>
                </div>
                <div class="buttons">
                    <button type="button" onclick="adjustValue('annualIncome', 1000000)">+100ë§Œ</button>
                    <button type="button" onclick="adjustValue('annualIncome', 10000000)">+1000ë§Œ</button>
                    <button type="button" onclick="adjustValue('annualIncome', 100000000)">+1ì–µ</button>
                </div>
                <div class="formatted-value" id="formatted-annualIncome">0ì›</div>
            </div>
            <div class="form-group">
                <label>ì£¼íƒ êµ¬ë§¤ì— í•„ìš”í•˜ì‹  ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”(ëŒ€ì¶œê¸ˆì•¡)</label>
                <div class="input-container">
                    <input type="number" th:field="*{loanStatusList[0].principal}" id="principal" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-principal')" />
                    <span class="unit">ì›</span>
                </div>
                <div class="buttons">
                    <button type="button" onclick="adjustValue('principal', 1000000)">+100ë§Œ</button>
                    <button type="button" onclick="adjustValue('principal', 10000000)">+1000ë§Œ</button>
                    <button type="button" onclick="adjustValue('principal', 100000000)">+1ì–µ</button>
                </div>
                <div class="formatted-value" id="formatted-principal">0ì›</div>
            </div>
			<div class="form-group">
			    <label>ëŒ€ì¶œìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”</label>
			    	<select th:field="*{loanStatusList[0].loanType}" style="width: 50%;">
					<option value="MORTGAGE">ì£¼íƒë‹´ë³´ëŒ€ì¶œ</option>
					<option value="INTERIM_PAYMENT_AND_MOVING">ì¤‘ë„ê¸ˆ ë° ì´ì£¼ë¹„</option>
					<option value="OFFICETEL_MORTGAGE_LOAN">ì˜¤í”¼ìŠ¤í…”ë‹´ë³´ëŒ€ì¶œ</option>
				    <option value="JEONSE_LOAN">ì „ì„¸ëŒ€ì¶œ</option>
				    <option value="JEONSE_DEPOSIT_COLLATERAL_LOAN">ì „ì„¸ë³´ì¦ê¸ˆë‹´ë³´ëŒ€ì¶œ</option>
				    <option value="PERSONAL_LOAN">ì‹ ìš©ëŒ€ì¶œ</option>
				    <option value="NON_HOUSING_REAL_ESTATE_COLLATERAL_LOAN">ë¹„ì£¼íƒ ë¶€ë™ì‚° ë‹´ë³´ ëŒ€ì¶œ</option>
				    <option value="OTHER_COLLATERAL_LOAN">ê¸°íƒ€ë‹´ë³´ ëŒ€ì¶œ</option>
				    <option value="DEPOSIT_AND_INSURANCE_COLLATERAL_LOAN">ì˜ˆì ê¸ˆ ë‹´ë³´ ë° ë³´í—˜ê³„ì•½ ëŒ€ì¶œ</option>
					<option value="SECURITIES_COLLATERAL_LOAN">ìœ ê°€ì¦ê¶Œ ë‹´ë³´ëŒ€ì¶œ</option>
					<option value="LONG_TERM_CARD_LOAN">ì¥ê¸°ì¹´ë“œëŒ€ì¶œ</option>
					<option value="OTHER_LOAN">ê¸°íƒ€ëŒ€ì¶œ</option>
			        </select>
			</div>
			<div class="form-group">
                <label>ë§¤ë‹¬ ë‚©ë¶€í•˜ì‹¤ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”(ìƒí™˜ë°©ì‹)</label>
                <select th:field="*{loanStatusList[0].repaymentType}" style="width: 50%;">
					<option value="BULLET">ì¼ì‹œìƒí™˜</option>
					<option value="AMORTIZING">ì›ë¦¬ê¸ˆê· ë“±ë¶„í• ìƒí™˜</option>
					<option value="EQUAL_PRINCIPAL">ì›ê¸ˆê· ë“±ë¶„í• ìƒí™˜</option>
                </select>
            </div>
            <div class="form-group">
                <label>ëŒ€ì¶œ ê¸°ê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                <div class="input-container">
                    <input type="number" th:field="*{loanStatusList[0].term}" id="term" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="updateFormattedValue(this, 'formatted-term')" />
                    <span class="unit">ê°œì›”</span>
                </div>
                <div class="buttons">
                    <button type="button" onclick="adjustValue('term', 12)">+1ë…„</button>
                    <button type="button" onclick="adjustValue('term', 60)">+5ë…„</button>
                    <button type="button" onclick="adjustValue('term', 120)">+10ë…„</button>
                </div>
            </div>
            <div class="form-group">
                <label>ì´ììœ¨</label>
                <div class="input-container">
                    <input type="number" step="0.01" th:field="*{loanStatusList[0].interestRatePercentage}" id="interestRatePercentage" placeholder="0" onfocus="this.placeholder=''" onblur="this.placeholder='0'" oninput="formatPercentage(this)" />
                    <span class="unit">%</span>
                </div>
                <div class="formatted-value" id="formatted-interestRatePercentage">0%</div>
            </div>
            <button type="submit" class="calculate">Calculate</button>
            <button type="button" class="reset" onclick="resetForm()">ì´ˆê¸°í™”</button>
        </form>
		<div class="result" th:if="${dtiCalcResponse != null}">
		    <h2>ê²°ê³¼</h2>
			    <p th:text="'ì£¼íƒë‹´ë³´ëŒ€ì¶œ ' + ${#numbers.formatInteger(dtiCalcResponse.dtiCalcResultList[0].principal, 1, 'COMMA')} + 'ì›ì˜ ê²½ìš°'"></p>
			    <p th:text="'(' + ${dtiCalcResponse.dtiCalcResultList[0].term} + 'ë…„' + ', ì›ë¦¬ê¸ˆê· ë“± ê¸°ì¤€)'"></p>
			    <p th:text="'ì—°ì†Œë“ì€ ' + ${#numbers.formatInteger(dtiCalcResponse.annualIncome, 1, 'COMMA')} + 'ì›ì´ë¯€ë¡œ'"></p>
			    <p th:text="'DTIëŠ” ì•½ ' + ${#numbers.formatInteger(dtiCalcResponse.finalDtiRatio, 2, 'COMMA' )} + '%ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.'"></p>
                <p class="section-title">ì—°ì›ê¸ˆ ìƒí™˜ì•¡</p>
                <p th:text="${#numbers.formatInteger(dtiCalcResponse.dtiCalcResultList[0].annualPrincipalRepayment,1,'COMMA')} + 'ì›'"></p>
                <p class="section-title">ì—°ì´ì ìƒí™˜ì•¡</p>
			    <p th:text="${#numbers.formatInteger(dtiCalcResponse.dtiCalcResultList[0].annualInterestRepayment,1,'COMMA')} + 'ì›'"></p>
			    <p class="section-title">ì—°ì†Œë“</p>
			    <p th:text="${#numbers.formatInteger(dtiCalcResponse.annualIncome,1,'COMMA')} + 'ì›'"></p>
			    <p class="section-title">DTI</p>
			    <p th:text="${#numbers.formatInteger(dtiCalcResponse.finalDtiRatio,2,'COMMA')} + '%'"></p>
        </div>
    </div>
    <script>
        function adjustValue(id, amount) {
            var input = document.getElementById(id);
            input.value = parseInt(input.value || 0) + amount;
            updateFormattedValue(input, 'formatted-' + id);
        }

        function resetForm() {
            document.querySelectorAll('input[type="number"], input[type="text"], input[type="date"], select').forEach(input => {
                input.value = '';
                input.placeholder = '0';
            });
            document.querySelectorAll('.formatted-value').forEach(el => el.textContent = '0ì›');
        }

        function formatCurrency(value) {
            var formattedValue = '';
            if (value >= 100000000) {
                var eok = Math.floor(value / 100000000);
                var remainder = value % 100000000;
                var man = Math.floor(remainder / 10000);
                if (man > 0) {
                    formattedValue = eok + 'ì–µ ' + man + 'ë§Œì›';
                } else {
                    formattedValue = eok + 'ì–µì›';
                }
            } else if (value >= 10000) {
                var man = Math.floor(value / 10000);
                var rest = value % 10000;
                formattedValue = man + 'ë§Œì›';
            } else {
                formattedValue = value.toLocaleString() + 'ì›';
            }
            return formattedValue;
        }

        function updateFormattedValue(input, formattedValueId) {
            var value = parseInt(input.value.replace(/,/g, '')) || 0;
            var formattedValue = formatCurrency(value);
            document.getElementById(formattedValueId).textContent = formattedValue;
        }

        function formatPercentage(input) {
            var value = parseFloat(input.value) || 0;
            document.getElementById('formatted-' + input.id).textContent = value.toFixed(2) + '%';
        }
    </script>
</body>
</html>